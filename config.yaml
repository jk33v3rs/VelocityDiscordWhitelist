# Configuration for VelocityDiscordWhitelist Plugin
# Version: 1.3.2
# Build: 20250525-2

# ==========================================
# CORE SETTINGS
# ==========================================

# Master switch for the entire plugin
enabled: false

# General configuration
general:
  # Enable debug logging for troubleshooting
  debug: false
  
  # Session timeout for verification process
  session:
    timeout:
      minutes: 10                   # Corrected to 10 minutes to match purgatory settings

# ==========================================
# DATABASE CONFIGURATION
# ==========================================

database:
  # Supported types: mysql, mariadb, postgresql, sqlite
  type: sqlite
  
  # Connection retry settings
  retry_count: 3
  retry_delay: 5000  # milliseconds
  
  # SQLite Configuration (used as fallback)
  sqlite:
    file_path: "plugins/velocitydiscordwhitelist/whitelist.db"
  
  # MySQL/MariaDB Configuration
  mysql:
    host: localhost
    port: 3306
    database: velocity_whitelist
    user: username
    password: strongpassword
    use_ssl: false
    
    # HikariCP connection pool settings
    connection_pool:
      maximum_pool_size: 10
      minimum_idle: 5
      connection_timeout: 30000
      idle_timeout: 600000
      max_lifetime: 1800000
    
    # Table configuration
    tables:
      whitelist: "whitelist"
      players: "players"
      rank_progression: "rank_progression"
      verification_sessions: "verification_sessions"

# ==========================================
# DISCORD INTEGRATION
# ==========================================

discord:
  enabled: false
  
  # Bot authentication
  token: ''  # Your Discord bot token (REQUIRED for Discord features)
  
  # Server and channel configuration
  server_id: ''  # Discord server/guild ID
  approved_channel_ids: ''  # Comma-separated list of channel IDs for /connectme
  
  # Connection settings
  init_timeout: 30  # seconds to wait for Discord connection
  
  # Feature toggles
  features:
    verification: true      # Enable Discord-based verification
    rank_sync: true        # Sync Discord roles with in-game ranks
    notifications: true    # Send Discord notifications for events
    commands: true         # Enable Discord commands (/connectme, /verify)

# ==========================================
# VAULT INTEGRATION
# ==========================================

vault:
  enabled: false
  
  # Economy integration
  economy:
    enabled: false
    
    # Reward amounts
    whitelist_reward: 1000        # Currency given when first whitelisted
    rank_base_reward: 500         # Base currency for rank progression
    subrank_multiplier: 0.5       # Multiplier for sub-rank rewards
    mainrank_multiplier: 2.0      # Multiplier for main rank rewards
  
  # Permission integration
  permissions:
    enabled: false
    
    # Group management
    default_group: "verified"     # Default group for whitelisted players
    
    # Rank-based group mappings (rank_level -> group_name)
    rank_groups:
      "1": "bronze"
      "2": "silver"
      "3": "gold"
      "4": "platinum"
      "5": "diamond"
      "1.1": "bronze_plus"
      "2.1": "silver_plus"
  
  # Server where rewards are applied
  reward_server: "survival"

# ==========================================
# LUCKPERMS INTEGRATION
# ==========================================

luckperms:
  enabled: false
  
  # Default group for whitelisted players
  default_group: "verified"
  
  # Rank progression group mappings
  rank_mappings:
    "1": "bronze"
    "2": "silver" 
    "3": "gold"
    "4": "platinum"
    "5": "diamond"
    "1.1": "bronze_plus"
    "2.1": "silver_plus"
    "3.1": "gold_plus"
  
  # Discord role to permission group mappings
  discord_mappings:
    "Moderator": "moderator"
    "VIP": "vip"
    "Supporter": "supporter"
    "Builder": "builder"
  
  # Group priority for determining primary group (higher = more important)
  group_priorities:
    "admin": 100
    "moderator": 90
    "vip": 80
    "diamond": 70
    "platinum": 60
    "gold": 50
    "silver": 40
    "bronze": 30
    "verified": 20
    "default": 10

# ==========================================
# REWARDS AND PROGRESSION
# ==========================================

rewards:
  enabled: false
  
  # Rank progression system
  progression:
    enabled: true
    
    # XP requirements for ranks (cumulative)
    rank_requirements:
      1: 0      # Bronze (starting rank)
      2: 1000   # Silver
      3: 3000   # Gold  
      4: 6000   # Platinum
      5: 10000  # Diamond
    
    # Sub-rank progression within main ranks
    subrank_requirements:
      base_xp: 500        # XP needed for first sub-rank
      multiplier: 1.5     # Multiplier for subsequent sub-ranks
  
  # Achievement system
  achievements:
    enabled: true
    
    # Achievement definitions loaded from achievements.json
    # This includes milestones, special events, etc.
  
  # Reward delivery
  delivery:
    # How rewards are given to players
    method: "auto"        # auto, manual, or command
    
    # Notification settings
    notifications:
      discord: true       # Notify in Discord
      in_game: true       # Notify in-game when player joins

# ==========================================
# XP SYSTEM CONFIGURATION
# ==========================================

xp:
  # Master switch for XP system
  enabled: true
  
  # Rate limiting to prevent XP farming
  rate_limiting:
    enabled: true
    max_events_per_minute: 10    # Maximum XP events per minute per player
    max_events_per_hour: 100     # Maximum XP events per hour per player
    max_events_per_day: 500      # Maximum XP events per day per player
    cooldown_seconds: 5          # Minimum seconds between same event types
    
    # Cleanup settings for rate limiting data
    cleanup:
      enabled: true
      interval_hours: 6          # Hours between cleanup runs
      retention_hours: 24        # Hours to keep rate limiting data
  
  # XP modifiers for different event types
  modifiers:
    advancement: 1.0             # Regular advancement multiplier
    playtime: 0.5               # Playtime XP multiplier (reduced to prevent AFK farming)
    kill: 0.8                   # PvP/mob kill multiplier
    break_block: 0.3            # Block breaking multiplier (heavily reduced to prevent mining farms)
    place_block: 0.2            # Block placing multiplier
    craft_item: 0.4             # Item crafting multiplier
    enchant_item: 1.2           # Item enchanting multiplier
    trade: 0.6                  # Villager trading multiplier
    fishing: 0.4                # Fishing multiplier
    mining: 0.3                 # Ore mining specific multiplier
  
  # BlazeAndCaves advancement integration
  blaze_and_caves:
    enabled: true
    
    # Difficulty-based XP multipliers
    difficulty_multipliers:
      easy: 1.0                 # Easy advancement multiplier
      medium: 1.25              # Medium advancement multiplier
      hard: 1.5                 # Hard advancement multiplier
      insane: 2.0               # Insane advancement multiplier
    
    # Variant bonuses
    variant_bonuses:
      terralith: 0.1            # 10% bonus for Terralith variant advancements
      hardcore: 0.5             # 50% bonus for Hardcore variant advancements
    
    # Default advancement mappings (can be overridden in advancements section)
    default_mappings:
      enabled: true             # Use default BlazeAndCaves 1.21 mappings
      auto_update: false        # Automatically update mappings on datapack updates
    
    # Custom advancement definitions
    advancements:
      # Format: "namespaced_key": { displayName, category, baseXP, isTerralithVariant, isHardcoreVariant, difficulty, description }
      # Example:
      # "blazeandcave:overworld/wooden_tools":
      #   displayName: "Wooden Tools"
      #   category: "overworld"
      #   baseXP: 10
      #   isTerralithVariant: false
      #   isHardcoreVariant: false
      #   difficulty: "easy"
      #   description: "Craft all wooden tools"
  
  # XP chart configuration for player information display
  chart:
    # Core display settings
    display_format: "fancy"      # Format options: simple, fancy, compact
    color_scheme: "gradient"     # Color scheme: default, gradient, monochrome, rainbow
    show_rate_limits: true       # Show current rate limiting status to players
    show_recent_events: true     # Show recent XP gains
    recent_events_limit: 10      # Number of recent events to display (1-50)
    show_modifiers: true         # Show XP modifier information
    show_tips: true              # Show progression tips
    show_rank_progress: true     # Show progress to next rank/sub-rank
    
    # Pagination settings for long lists
    pagination:
      enabled: true              # Enable pagination for long charts
      items_per_page: 15         # Items to show per page
      show_page_numbers: true    # Show page navigation
    
    # Progress bar configuration
    progress_bar:
      enabled: true
      length: 20                # Length of progress bar in characters (10-50)
      filled_char: "█"          # Character for filled portions
      empty_char: "░"           # Character for empty portions
      show_percentage: true     # Show percentage alongside bar
      use_colors: true          # Use colors in progress bars
      fill_color: "GREEN"       # Color for filled portion
      empty_color: "GRAY"       # Color for empty portion
      bracket_style: "square"   # Options: square, round, angle, none
      bracket_color: "WHITE"    # Color for brackets
    
    # Content sections configuration
    sections:
      main:
        show_header: true            # Show decorative header
        show_advancement_xp: true    # Show regular advancement XP values
        show_blazeandcave_xp: true   # Show BlazeAndCave XP values
        show_other_sources: true     # Show playtime, kills, etc.
        show_navigation_help: true   # Show subcommand navigation
      
      blazeandcave:
        show_formula: true           # Show XP calculation formula
        show_difficulty_multipliers: true  # Show difficulty bonuses
        show_variant_bonuses: true   # Show Terralith/Hardcore bonuses
        show_examples: true          # Show calculation examples
        show_categories: true        # Show advancement categories
      
      ranks:
        show_structure_explanation: true  # Explain main ranks vs sub-ranks
        show_sample_progression: true     # Show sample rank progression
        show_requirements_breakdown: true # Show XP/time requirements
        show_higher_ranks_preview: true  # Preview of higher rank names
      
      rates:
        show_anti_farming_explanation: true  # Explain purpose
        show_cooldown_periods: true          # Show cooldown times
        show_rate_limits: true               # Show limit numbers
        show_xp_modifiers: true              # Show source modifiers
        show_efficiency_tips: true           # Show progression tips
        show_limit_behavior: true            # Explain what happens at limits
    
    # Format-specific settings
    formats:
      simple:
        use_minimal_colors: true     # Minimal color usage
        compact_spacing: true        # Tighter spacing
        hide_decorative_elements: true  # No fancy headers/footers
      
      fancy:
        use_unicode_symbols: true    # Use emojis and unicode
        decorative_headers: true     # Fancy headers with symbols
        gradient_colors: true        # Use color gradients
        animated_elements: false     # Animated text (future feature)
      
      compact:
        single_line_items: true      # One line per item where possible
        abbreviated_labels: true     # Use shorter text
        minimal_whitespace: true     # Reduce spacing
        essential_info_only: true    # Only show critical information
    
    # Customization options
    customization:
      headers:
        main: "═══ XP Chart - What Grants XP ═══"
        blazeandcave: "═══ BlazeAndCave 1.21 XP Chart ═══"
        ranks: "═══ Rank Requirements Chart ═══"
        rates: "═══ XP Rate Limiting ═══"
      
      symbols:
        advancement: "🏆"            # Regular advancements
        blazeandcave: "🔥"          # BlazeAndCave advancements
        playtime: "⏰"              # Playtime XP
        ranks: "🏅"                 # Rank system
        protection: "🛡️"           # Rate limiting
        tips: "💡"                  # Tips section
      
      formatting:
        section_spacing: 1           # Lines between sections (0-3)
        item_spacing: 0             # Lines between items (0-2)
        indent_size: 2              # Spaces for indentation
        max_line_length: 80         # Maximum line length for wrapping
    
    # Performance and caching
    performance:
      cache_enabled: true          # Cache formatted chart content
      cache_duration_minutes: 5    # How long to cache content
      lazy_load_sections: true     # Load sections on demand
      max_concurrent_requests: 10  # Limit concurrent chart requests
      command_cooldown_seconds: 30 # Cooldown for /xpchart command
      per_player_rate_limit: 5     # Max chart requests per minute per player
    
    # Integration settings
    integration:
      discord_embed_support: false  # Future: Discord embed format
      web_api_format: false        # Future: JSON API format
      placeholder_api: true        # PlaceholderAPI support (if available)
      allow_data_export: false     # Allow players to export their data
      export_formats: []           # Future: CSV, JSON export formats

# ==========================================
# GEYSER/BEDROCK SUPPORT
# ==========================================

geyser:
  enabled: false
  prefix: '.'  # Prefix used for Bedrock usernames

# ==========================================
# VERIFICATION SETTINGS
# ==========================================

validation:
  # Account verification options
  mojang_verification: true     # Verify Java accounts through Mojang
  geyser_verification: true     # Verify Bedrock accounts through Geyser
  
  # Verification process settings
  timeout: 10                   # Minutes before verification expires (corrected to 10)
  code_format: '***-***'        # Format pattern for verification codes
  max_verification_attempts: 4  # Maximum verification attempts before lockout
  
  # Purgatory system
  purgatory:
    enabled: true
    server: "hub"               # Server where unverified players wait (corrected to "hub")
    max_sessions: 100           # Maximum concurrent verification sessions
    grace_period_minutes: 10    # Grace period for slow verifiers (configurable)
    default_allowed_server: "hub" # Default server for new sessions
    timeout_minutes: 10         # Default timeout for verification sessions (corrected to 10 minutes)
    adventure_mode_lock: true   # Lock players in adventure mode
    transfer_packet_blocking: true # Block transfer packets for purgatory players
    
    # Session management
    session_management:
      cleanup_enabled: true
      cleanup_interval_minutes: 30    # Configurable cleanup interval (was fixed)
      expired_session_retention_minutes: 60  # How long to keep expired sessions
      max_inactive_time_minutes: 15   # Maximum inactive time before session cleanup

# ==========================================
# SERVER SETTINGS
# ==========================================

servers:
  # Default server for new/unverified players
  lobby_server: "lobby"
  
  # Server where main gameplay happens
  main_server: "survival"
  
  # Server-specific whitelist rules
  per_server_whitelist: false

# ==========================================
# MESSAGES AND NOTIFICATIONS
# ==========================================

messages:
  # Player-facing messages
  not_whitelisted: "Sorry, you are not whitelisted. Please visit our Discord to gain access."
  verification_expired: "Your verification session has expired. Please try again."
  verification_success: "Welcome! You have been successfully whitelisted."
  rank_up: "Congratulations! You've reached rank {rank}!"
  
  # Discord messages
  discord:
    verification_start: "Verification started for {player}. Code: {code}"
    verification_complete: "Player {player} has been successfully verified!"
    rank_progression: "{player} has progressed to rank {rank}!"

# ==========================================
# ADVANCED FEATURES
# ==========================================

advanced:
  # Performance settings
  cache:
    enabled: true
    ttl_minutes: 15             # Cache timeout in minutes
    max_entries: 1000           # Maximum cached entries
  
  # Metrics and monitoring
  metrics:
    enabled: true               # Enable bStats metrics
    custom_charts: true         # Include custom metric charts
  
  # API integration
  api:
    enabled: false              # Enable REST API for external integrations
    port: 8080                  # API server port
    auth_token: ""              # API authentication token
  
  # Backup and maintenance
  backup:
    enabled: false              # Auto-backup of database
    interval_hours: 24          # Hours between backups
    retention_days: 7           # Days to keep backups
    
    # Manual backup/restore
    manual_operations:
      enabled: true             # Allow manual data dump/backup operations
      compression: true         # Compress backup files
      include_xp_events: true   # Include XP events in backups
      include_sessions: false   # Include verification sessions in backups
  
  # Hot reload functionality
  hot_reload:
    enabled: true               # Enable configuration hot reload
    watch_config_file: true     # Watch config file for changes
    reload_components:          # Components that support hot reload
      - "messages"              # Reload messages.yml
      - "ranks"                 # Reload ranks.yml
      - "xp_settings"           # Reload XP configuration
      - "rate_limits"           # Reload rate limiting settings
    auto_reload_delay_seconds: 5 # Delay before applying changes

# ==========================================
# COMMAND CONFIGURATION
# ==========================================

commands:
  # Player-facing commands
  player_commands:
    enabled: true
    
    # /rank command configuration
    rank:
      enabled: true
      cooldown_seconds: 30      # Cooldown between /rank uses
      show_progress: true       # Show progress to next rank
      show_xp_total: true       # Show total XP earned
      show_recent_gains: true   # Show recent XP gains
      permission: "vdw.player.rank"  # Permission node required
    
    # /xpchart command configuration
    xpchart:
      enabled: true
      cooldown_seconds: 60      # Cooldown between /xpchart uses
      show_rate_limits: true    # Show current rate limiting status
      show_modifiers: true      # Show XP modifier information
      permission: "vdw.player.xpchart"  # Permission node required
    
    # /progress command configuration (alias for /rank)
    progress:
      enabled: true
      alias_for: "rank"         # Command this aliases to
      permission: "vdw.player.progress"
  
  # Admin commands
  admin_commands:
    enabled: true
    base_permission: "vdw.admin"  # Base permission for all admin commands
    
    # Security settings
    security:
      hide_error_details: true  # Hide detailed error messages from non-admins
      log_admin_actions: true   # Log all admin command usage
      require_confirmation: true # Require confirmation for destructive actions
    
    # Available admin commands
    available_commands:
      - "whitelist"             # Whitelist management
      - "reload"                # Configuration reload
      - "backup"                # Manual backup operations
      - "xp"                    # XP management commands
      - "debug"                 # Debug commands
      - "cleanup"               # Manual cleanup operations

# ==========================================
# SECURITY CONFIGURATION
# ==========================================

security:
  # Permission-based security
  permissions:
    strict_mode: true           # Enforce strict permission checking
    default_permissions:        # Default permissions for new players
      - "vdw.player.rank"
      - "vdw.player.progress"
    
    # Admin permission inheritance
    admin_inherits_player: true # Admins automatically get player permissions
  
  # Error message visibility
  error_messages:
    show_to_players: false      # Show detailed errors to regular players
    show_to_admins: true        # Show detailed errors to admins
    log_all_errors: true        # Log all errors regardless of visibility
  
  # Rate limiting for commands
  command_rate_limiting:
    enabled: true
    global_cooldown: 1          # Global cooldown between any commands (seconds)
    per_command_cooldowns:      # Individual command cooldowns
      rank: 30
      xpchart: 60
      progress: 30
    
    # Anti-spam measures
    max_commands_per_minute: 10 # Maximum commands per minute per player
    lockout_duration_minutes: 5 # Lockout duration for spamming

# ==========================================
# TNE ECONOMY INTEGRATION
# ==========================================

tne:
  enabled: false                # Enable The New Economy integration
  
  # Currency settings
  currency:
    default_currency: "coin"    # Default currency to use
    precision: 2                # Decimal places for currency amounts
  
  # Reward configuration
  rewards:
    whitelist_bonus: 1000.0     # Currency given when first whitelisted
    rank_progression_bonus: 500.0  # Base currency for rank progression
    xp_conversion:
      enabled: false            # Convert XP gains to currency
      rate: 0.1                 # Currency per XP point
      minimum_xp: 10            # Minimum XP before conversion
  
  # Account linking
  account_linking:
    auto_create_accounts: true  # Automatically create TNE accounts for new players
    starting_balance: 100.0     # Starting balance for new accounts
    account_prefix: "VDW_"      # Prefix for VDW-created accounts
